package com.springboot.springboot.service.personne;


import com.springboot.springboot.dto.disponibilite.DisponibiliteFormateurDTO;
import com.springboot.springboot.entity.personne.DisponibiliteFormateur;
import com.springboot.springboot.entity.personne.Formateur;
import com.springboot.springboot.repository.personne.DisponibiliteFormateurRepository;
import com.springboot.springboot.repository.personne.FormateurRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.Optional;

@Service
public class DisponibiliteFormateurService {

    @Autowired
    private DisponibiliteFormateurRepository repository;

    @Autowired
    private FormateurRepository formateurRepository;

    public List<DisponibiliteFormateur> findAll() {
        return repository.findAll();
    }

    public Optional<DisponibiliteFormateur> findById(int id) {
        return repository.findById(id);
    }

    public DisponibiliteFormateur save(DisponibiliteFormateur disponibilite) {
        return repository.save(disponibilite);
    }

    public DisponibiliteFormateur saveFromDTO(DisponibiliteFormateurDTO dto) {
        Formateur formateur = formateurRepository.findById(dto.getFormateurId())
                .orElseThrow(() -> new RuntimeException("Formateur avec ID " + dto.getFormateurId() + " introuvable"));

        DisponibiliteFormateur disponibilite = new DisponibiliteFormateur();
        if (dto.getId() > 0) {
            disponibilite.setId(dto.getId());
        }
        disponibilite.setFormateur(formateur);
        disponibilite.setJourSemaine(dto.getJourSemaine());
        disponibilite.setHeureDebut(dto.getHeureDebut());
        disponibilite.setHeureFin(dto.getHeureDebut());
        disponibilite.setEstDisponible(dto.getEstDisponible() != null ? dto.getEstDisponible() : true);

        return repository.save(disponibilite);
    }

    public void deleteById(int id) {
        repository.deleteById(id);
    }
}